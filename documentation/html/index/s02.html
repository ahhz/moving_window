<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Motivating Example</title>
<link rel="stylesheet" href="../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="../index.html" title="Chapter&#160;1.&#160;Moving Window">
<link rel="up" href="../index.html" title="Chapter&#160;1.&#160;Moving Window">
<link rel="prev" href="../index.html" title="Chapter&#160;1.&#160;Moving Window">
<link rel="next" href="s03.html" title="Installation">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="spirit-nav">
<a accesskey="p" href="../index.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="s03.html"><img src="../images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="idm1568862784"></a>Motivating Example</h2></div></div></div>
<p>The following is an example of a program making use of the built-in
  edge-density indicator:</p>
<pre class="programlisting">
#include &lt;blink/moving_window/indicator/edge_density.h&gt;
#include &lt;blink/moving_window/moving_window_view.h&gt;
#include &lt;blink/moving_window/window.h&gt;

#include &lt;blink/iterator/zip_range.h&gt;
#include &lt;blink/raster/utility.h&gt;

#include &lt;functional&gt;
#include &lt;tuple&gt;

int main()
{
  double radius = 10;

  // open a raster data set
  auto input = blink::raster::open_gdal_raster&lt;int&gt;("input.tif", GA_ReadOnly);

  // create a raster data set, with same dimensions as input
  auto output = blink::raster::create_gdal_raster_from_model&lt;double&gt;("output.tif", input);

  // create the window to use
  auto window = blink::moving_window::make_square_window(radius);

  // Create a range over the windowed indicator for all pixels
  auto window_view = blink::moving_window::make_moving_window_view(edge_density_tag(), window, &amp;input);

  // Create a range to simultaneously iterate over output and window_view
  auto zip = blink::iterator::make_zip_range(std::ref(output), std::ref(window_view));

  // extract the indicator value for each pixel and assign to output
  for (auto&amp;&amp; i : zip) {
    auto&amp; output_i = std::get&lt;0&gt;(i);
    auto&amp; window_i = std::get&lt;1&gt;(i);
    output_i = window_i.extract().get();
  }

  return 0;
}</pre>
<p>The central element of the example is the window_view; this is a range
  that allows iterating over all pixel locations in the raster dataset.
  However, instead of giving access to the pixel values it gives access to the
  indicator that summarizes the window surrounding the pixel. At each
  iteration step the window moves along with the pixel.</p>
<p>The zip range makes it possible to iterate simultaneously over both
  the output dataset and the moving window view of the input data set. Thus at
  each step we can extract the indicator value and assign it to the
  corresponding pixel in the output raster.</p>
<p>The<code class="computeroutput"> extract()</code> member function of the <code class="computeroutput">window_view
  </code>returns the indicator associated with <code class="computeroutput">edge_density_tag</code>,
  in this case for the square window with a radius of 40 pixels. The
  additional <code class="computeroutput">get()</code> is necessary because the return type of
  <code class="computeroutput">extract()</code> is a <code class="computeroutput">boost::optional</code>).</p>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer"></div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="../index.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="s03.html"><img src="../images/next.png" alt="Next"></a>
</div>
</body>
</html>
